<h1>New Sales Order for Customer: <%= @user.pretty_name %></h1>


<% form_tag :action => 'add_item', :id => @user.id do %>
<p>
  Product Type <%= select_tag :product_type,  options_for_select(@available_product_types), {:onchange => remote_function(:url => {:action => :update_products}, :with => "'product_type='+value")} %>
</p>

<p>
  <div id="product"><%= render :partial => 'product', :object => @available_products %></div>
</p>

<p>
  Quantity <%= select_tag :quantity, options_for_select(@available_quantities) %>
</p>

<%= submit_tag 'Add Item' %>
<% end %> 

<hr>

<table class="listing" width="100%">
  <tr>
    <th>Type</th>
    <th>Product</th>
    <th>Supplier</th>
    <th>Quantity</th>
    <th>Unit Price</th>
    <th>Price</th>
  </tr>

  <% @basket.items.each do |item| %>
  <td class="text"><%= item.product_type_name %></td>
  <td class="text"><%= item.product_name %></td>
  <td class="text"><%= item.supplier_name %></td>
  <td class="status"><%= item.quantity %> <%= item.units_of_measure %></td>
  <td class="number"><%= format_currency(item.price) %></td>
  <td class="number"><%= format_currency(item.total_price) %></td>
</tr>
<% end %>
</table>

<p>
  <%= button_to 'Create Order', :action => 'create', :id => @user.id %>
</p>                                                                
